/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is not neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
/******/ (() => { // webpackBootstrap
/******/ 	"use strict";
/******/ 	var __webpack_modules__ = ({

/***/ "./src/scripts/controller.js":
/*!***********************************!*\
  !*** ./src/scripts/controller.js ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => /* binding */ Controller\n/* harmony export */ });\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nvar Controller = /*#__PURE__*/function () {\n  function Controller(model) {\n    _classCallCheck(this, Controller);\n\n    this.model = model;\n  }\n\n  _createClass(Controller, [{\n    key: \"_initApp\",\n    value: function _initApp() {\n      var _this = this;\n\n      this.model.initCityList();\n      this.model.initWidgets();\n      this.model.view.container.addEventListener('click', function (e) {\n        if (e.target.id === \"add\") {\n          _this.model.getNewCity(_this.model.view.input.value);\n\n          _this.model.view.clearInput();\n        } else if (e.target.dataset.id === \"delete\") {\n          _this.model.deleteFromServer(e.target.parentNode.id);\n\n          _this.model.view.removeCity(e.target);\n        } else if (e.target.dataset.type === \"location\") {\n          _this.model.view.reNameCity(e.target);\n        } else if (e.target.dataset.type === \"save\") {\n          _this.model.renameCity(e.target.previousSibling.value, e.target.parentNode);\n        } else if (e.target.dataset.type === \"close\") {\n          _this.model.view.cancelChange(e.target);\n        }\n      });\n      this.model.view.widgets.addEventListener('click', function (e) {\n        if (e.target.id === \"locationAllow\") {\n          _this.model.initGeoWidget();\n        }\n      });\n    }\n  }]);\n\n  return Controller;\n}();\n\n\n\n//# sourceURL=webpack://weather-app/./src/scripts/controller.js?");

/***/ }),

/***/ "./src/scripts/model.js":
/*!******************************!*\
  !*** ./src/scripts/model.js ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => /* binding */ Model\n/* harmony export */ });\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nvar Model = /*#__PURE__*/function () {\n  function Model(view) {\n    var _this = this;\n\n    _classCallCheck(this, Model);\n\n    _defineProperty(this, \"initCurrencyWidget\", function () {\n      _this.view.clearCurrencyWidget();\n\n      var promise = fetch('https://api.privatbank.ua/p24api/pubinfo?json&exchange&coursid=5');\n      promise.then(function (res) {\n        if (res.ok && res.status === 200) {\n          return res.json();\n        } else {\n          return Promise.reject(res.status);\n        }\n      }).then(function (res) {\n        return res.forEach(function (item) {\n          _this.view.pictureCurrencyWidget(\"\".concat(item.ccy, \"/\").concat(item.base_ccy, \" : \").concat(item.buy, \"/\").concat(item.sale));\n        });\n      });\n      setTimeout(_this.initCurrencyWidget, 3600000);\n    });\n\n    _defineProperty(this, \"initGeoWidget\", function () {\n      var success = function success(position) {\n        var lat = position.coords.latitude;\n        var lon = position.coords.longitude;\n        var promise = fetch(\"https://api.openweathermap.org/data/2.5/weather?lat=\".concat(lat, \"&lon=\").concat(lon, \"&appid=e50ec27dac6fac01c3d6889743f8b9d5\"));\n        promise.then(function (res) {\n          if (res.ok && res.status === 200) {\n            return res.json();\n          } else {\n            return Promise.reject(res.status);\n          }\n        }).then(function (res) {\n          return _this.view.pictureGeoWidget(res.name, _this.calculateTempreture(res.main.temp), _this.getWeatherImage(res['weather'][0].icon));\n        });\n      };\n\n      var error = function error() {\n        _this.view.geoWidgetWait('Unable to retrieve your location');\n      };\n\n      if (!navigator.geolocation) {\n        _this.view.geoWidgetWait('Geolocation is not supported by your browser');\n      } else {\n        _this.view.geoWidgetWait('Locatingâ€¦');\n\n        navigator.geolocation.getCurrentPosition(success, error);\n      }\n    });\n\n    _defineProperty(this, \"getNewCity\", function (cityName) {\n      var promise = fetch('https://api.openweathermap.org/data/2.5/weather?q=' + cityName + '&appid=e50ec27dac6fac01c3d6889743f8b9d5');\n      promise.then(function (res) {\n        if (res.ok && res.status === 200) {\n          return res.json();\n        } else {\n          return Promise.reject(res.status);\n        }\n      }).then(function (res) {\n        return _this.saveToServer(res);\n      })[\"catch\"](function (err) {\n        return _this.view.alertMessage('No such city!');\n      });\n    });\n\n    _defineProperty(this, \"saveToServer\", function (responseFromWeather) {\n      var city = {\n        name: responseFromWeather['name']\n      };\n      var promise = fetch('http://localhost:3333/add', {\n        method: \"POST\",\n        headers: {\n          'Content-type': 'application/json;charset=utf-8'\n        },\n        body: JSON.stringify(city)\n      });\n      promise.then(function (res) {\n        if (res.ok && res.status === 200) {\n          return res.json();\n        } else {\n          return Promise.reject(res.status);\n        }\n      }).then(function (res) {\n        return _this.view.buildCityBlock(responseFromWeather, _this.getWeatherImage(responseFromWeather['weather'][0].icon), _this.calculateTempreture(responseFromWeather.main.temp), res);\n      })[\"catch\"](function (err) {\n        return console.log(err);\n      });\n    });\n\n    this.view = view;\n  }\n\n  _createClass(Model, [{\n    key: \"initCityList\",\n    value: function initCityList() {\n      var _this2 = this;\n\n      var promise = fetch('http://localhost:3333/cities');\n      promise.then(function (res) {\n        return res.json();\n      }).then(function (res) {\n        return res.forEach(function (item) {\n          _this2.refreshData(item.name, item._id);\n        });\n      })[\"catch\"](function (err) {\n        return console.log(err);\n      });\n    }\n  }, {\n    key: \"initWidgets\",\n    value: function initWidgets() {\n      this.view.pictureWidgetsBlock();\n      this.initCurrencyWidget();\n    }\n  }, {\n    key: \"refreshData\",\n    value: function refreshData(cityName, id) {\n      var _this3 = this;\n\n      var promise = fetch('https://api.openweathermap.org/data/2.5/weather?q=' + cityName + '&appid=e50ec27dac6fac01c3d6889743f8b9d5');\n      promise.then(function (res) {\n        if (res.ok && res.status === 200) {\n          return res.json();\n        } else {\n          return Promise.reject(res.status);\n        }\n      }).then(function (res) {\n        _this3.view.buildCityBlock(res, _this3.getWeatherImage(res['weather'][0].icon), _this3.calculateTempreture(res.main.temp), id);\n      })[\"catch\"](function (err) {\n        return _this3.view.alert(err);\n      });\n    }\n  }, {\n    key: \"renameCity\",\n    value: function renameCity(cityName, parentNode) {\n      var _this4 = this;\n\n      var promise = fetch('https://api.openweathermap.org/data/2.5/weather?q=' + cityName + '&appid=e50ec27dac6fac01c3d6889743f8b9d5');\n      promise.then(function (res) {\n        if (res.ok && res.status === 200) {\n          return res.json();\n        } else {\n          return Promise.reject(res.status);\n        }\n      }).then(function (res) {\n        return _this4.changeAtServer(cityName, parentNode.id, res, parentNode);\n      })[\"catch\"](function (err) {\n        return err ? _this4.view.alertMessage('No such city!') : console.log('no error');\n      });\n    }\n  }, {\n    key: \"getWeatherImage\",\n    value: function getWeatherImage(code) {\n      return \"http://openweathermap.org/img/wn/\".concat(code, \"@2x.png\");\n    }\n  }, {\n    key: \"calculateTempreture\",\n    value: function calculateTempreture(kelvin) {\n      return Math.ceil(Number(kelvin) - 273.15);\n    }\n  }, {\n    key: \"deleteFromServer\",\n    value: function deleteFromServer(id) {\n      this.cityList--;\n      var promise = fetch('http://localhost:3333/' + id, {\n        method: \"DELETE\"\n      });\n      promise.then(function (res) {\n        if (res.ok && res.status === 200) {\n          return res.json();\n        } else {\n          return Promise.reject(res.status);\n        }\n      })[\"catch\"](function (err) {\n        return console.log(err);\n      });\n    }\n  }, {\n    key: \"changeAtServer\",\n    value: function changeAtServer(cityName, id, freshData, parentNode) {\n      var _this5 = this;\n\n      var city = {\n        name: cityName\n      };\n      var promise = fetch('http://localhost:3333/' + id, {\n        method: \"PUT\",\n        headers: {\n          'Content-type': 'application/json;charset=utf-8'\n        },\n        body: JSON.stringify(city)\n      });\n      promise.then(function (res) {\n        if (res.ok && res.status === 200) {\n          return res.text();\n        } else {\n          return Promise.reject(res.status);\n        }\n      }).then(function (res) {\n        return _this5.view.buildCityBlock(freshData, _this5.getWeatherImage(freshData['weather'][0].icon), _this5.calculateTempreture(freshData.main.temp), id, parentNode);\n      }).then(function (res) {\n        return _this5.view.alertMessage('City has been changed!');\n      })[\"catch\"](function (err) {\n        return console.log(err);\n      });\n    }\n  }]);\n\n  return Model;\n}();\n\n\n\n//# sourceURL=webpack://weather-app/./src/scripts/model.js?");

/***/ }),

/***/ "./src/scripts/script.js":
/*!*******************************!*\
  !*** ./src/scripts/script.js ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _view__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./view */ \"./src/scripts/view.js\");\n/* harmony import */ var _model__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./model */ \"./src/scripts/model.js\");\n/* harmony import */ var _controller__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./controller */ \"./src/scripts/controller.js\");\n\n\n\ndocument.addEventListener('DOMContentLoaded', function () {\n  var view = new _view__WEBPACK_IMPORTED_MODULE_0__.default();\n  var model = new _model__WEBPACK_IMPORTED_MODULE_1__.default(view);\n  var controller = new _controller__WEBPACK_IMPORTED_MODULE_2__.default(model);\n\n  controller._initApp();\n});\n\n//# sourceURL=webpack://weather-app/./src/scripts/script.js?");

/***/ }),

/***/ "./src/scripts/view.js":
/*!*****************************!*\
  !*** ./src/scripts/view.js ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => /* binding */ View\n/* harmony export */ });\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nvar View = /*#__PURE__*/function () {\n  function View() {\n    _classCallCheck(this, View);\n\n    this.container = document.querySelector('.container');\n    this.input = document.querySelector('input');\n    this.widgets = document.createElement('div');\n    this.currencyWidget = document.createElement('div');\n    this.geoWidget = document.createElement('div');\n  }\n\n  _createClass(View, [{\n    key: \"buildCityBlock\",\n    value: function buildCityBlock(res, imagesrc, temp, id, currentBlock) {\n      if (!currentBlock) {\n        var cityBlock = document.createElement('div');\n        cityBlock.id = id;\n        cityBlock.classList.add('city');\n        this.container.append(cityBlock);\n        this.content2CityBlock(cityBlock, res, imagesrc, temp);\n      } else {\n        currentBlock.innerHTML = '';\n        this.content2CityBlock(currentBlock, res, imagesrc, temp);\n      }\n    }\n  }, {\n    key: \"content2CityBlock\",\n    value: function content2CityBlock(cityBlock, res, imagesrc, temp) {\n      var cityCountry = document.createElement('h2');\n      var button = document.createElement('button');\n      var image = document.createElement('img');\n      var tempreture = document.createElement('h3');\n      var maxInfo = document.createElement('div');\n      var skyState = document.createElement('h3');\n      var windSpeed = document.createElement('h3');\n      var humidity = document.createElement('h3');\n      cityCountry.setAttribute('data-type', 'location');\n      cityCountry.classList.add('city-country');\n      button.classList.add('delete-button');\n      button.classList.add('floating-button');\n      button.innerHTML = 'DELETE';\n      button.setAttribute('data-id', \"delete\");\n      image.setAttribute('src', imagesrc);\n      tempreture.innerHTML = \"\".concat(temp, \" &deg C\");\n      maxInfo.classList.add('maxInfo');\n      skyState.innerHTML = res.weather[0].description;\n      windSpeed.innerHTML = \"wind: \".concat(res.wind.speed, \"mph\");\n      humidity.innerHTML = \"humidity: \".concat(res.main.humidity, \"%\");\n      cityCountry.innerText = \"\".concat(res.name, \", \").concat(res.sys.country);\n      cityBlock.append(cityCountry, image, tempreture, maxInfo, button);\n      maxInfo.append(skyState, windSpeed, humidity);\n    }\n  }, {\n    key: \"clearInput\",\n    value: function clearInput() {\n      this.input.value = '';\n    }\n  }, {\n    key: \"removeCity\",\n    value: function removeCity(target) {\n      target.parentNode.remove();\n    }\n  }, {\n    key: \"reNameCity\",\n    value: function reNameCity(target) {\n      var div = target.parentNode;\n      var input = document.createElement('input');\n      var buttonSave = document.createElement('button');\n      var buttonClose = document.createElement('button');\n      buttonClose.setAttribute('data-type', 'close');\n      buttonSave.setAttribute('data-type', 'save');\n      input.classList.add('change-city-input');\n      buttonClose.classList.add('close-change-button');\n      buttonClose.classList.add('floating-button');\n      buttonSave.classList.add('change-city-button');\n      buttonSave.classList.add('floating-button');\n      input.setAttribute('placeholder', 'Enter new city...');\n      buttonSave.innerHTML = \"save\";\n      buttonClose.innerHTML = \"close\";\n      div.append(input, buttonSave, buttonClose);\n    }\n  }, {\n    key: \"cancelChange\",\n    value: function cancelChange(buttonClose) {\n      buttonClose.previousSibling.remove();\n      buttonClose.previousSibling.remove();\n      buttonClose.remove();\n    }\n  }, {\n    key: \"pictureWidgetsBlock\",\n    value: function pictureWidgetsBlock() {\n      this.widgets.classList.add('widgets');\n      this.currencyWidget.classList.add('smallWidget');\n      this.geoWidget.classList.add('smallWidget');\n      var button = document.createElement('button');\n      button.id = 'locationAllow';\n      button.classList.add('floating-button');\n      button.innerHTML = \"Receive your weather\";\n      this.geoWidget.append(button);\n      this.widgets.append(this.geoWidget, this.currencyWidget);\n      document.body.append(this.widgets);\n    }\n  }, {\n    key: \"pictureCurrencyWidget\",\n    value: function pictureCurrencyWidget(curr) {\n      var currency = document.createElement('p');\n      currency.innerHTML = curr;\n      this.currencyWidget.append(currency);\n    }\n  }, {\n    key: \"pictureGeoWidget\",\n    value: function pictureGeoWidget(cityName, temp, imgSrc) {\n      this.geoWidget.innerHTML = '';\n      var city = document.createElement('h2');\n      var tempreture = document.createElement('h2');\n      var img = document.createElement('img');\n      city.innerHTML = cityName;\n      tempreture.innerHTML = \"\".concat(temp, \" &deg C\");\n      img.setAttribute('src', imgSrc);\n      this.geoWidget.append(city, tempreture, img);\n    }\n  }, {\n    key: \"geoWidgetWait\",\n    value: function geoWidgetWait(text) {\n      this.geoWidget.innerHTML = '';\n      var h4 = document.createElement('h4');\n      h4.innerText = text;\n      this.geoWidget.append(h4);\n    }\n  }, {\n    key: \"clearCurrencyWidget\",\n    value: function clearCurrencyWidget() {\n      this.currencyWidget.innerHTML = '';\n    }\n  }, {\n    key: \"alertMessage\",\n    value: function alertMessage(text) {\n      var div = document.createElement('div');\n      div.classList.add('alert');\n      var h1 = document.createElement('h1');\n      h1.innerHTML = text;\n      div.style.top = window.pageYOffset + document.documentElement.clientHeight / 3 + 'px';\n      div.append(h1);\n      this.container.append(div);\n      setTimeout(this.removeAlertMessage, 2000);\n    }\n  }, {\n    key: \"removeAlertMessage\",\n    value: function removeAlertMessage() {\n      var div = document.querySelector('.alert');\n      div.remove();\n    }\n  }]);\n\n  return View;\n}();\n\n\n\n//# sourceURL=webpack://weather-app/./src/scripts/view.js?");

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		if(__webpack_module_cache__[moduleId]) {
/******/ 			return __webpack_module_cache__[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId](module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/define property getters */
/******/ 	(() => {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = (exports, definition) => {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => Object.prototype.hasOwnProperty.call(obj, prop)
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/************************************************************************/
/******/ 	// startup
/******/ 	// Load entry module
/******/ 	__webpack_require__("./src/scripts/script.js");
/******/ 	// This entry module used 'exports' so it can't be inlined
/******/ })()
;